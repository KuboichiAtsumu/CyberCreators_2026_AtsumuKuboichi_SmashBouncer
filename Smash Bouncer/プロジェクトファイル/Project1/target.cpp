//==============================================================================================================================================
//
// ターゲットに関する処理
// Author : Atsumu Kuboichi
//
//==============================================================================================================================================

//===========================================================================================================
// ヘッダーインクルード
//===========================================================================================================
#include "target.h"//ターゲット

//===========================================================================================================
// コンストラクタ
//===========================================================================================================
CTarget::CTarget(int nPriority) : CEffect3D(nPriority)
{
}

//===========================================================================================================
// デストラクタ
//===========================================================================================================
CTarget::~CTarget()
{
}

//===========================================================================================================
// 初期化処理
//===========================================================================================================
HRESULT CTarget::Init()
{
	//パラメータ設定
	SetLife(70);

	//3Dエフェクト初期化処理
	if (FAILED(CEffect3D::Init()))
	{
		return E_FAIL;
	}

	return S_OK;
}

//===========================================================================================================
// 終了処理
//===========================================================================================================
void CTarget::Uninit()
{
	//3Dエフェクト終了処理
	CEffect3D::Uninit();
}

//===========================================================================================================
// 解放処理
//===========================================================================================================
void CTarget::Release()
{
	//3Dエフェクト解放処理
	CEffect3D::Release();
}

//===========================================================================================================
// 更新処理
//===========================================================================================================
void CTarget::Update()
{
	//回転処理
	Rotation();

	//対象オブジェクトとの距離を求める
	DecLife();

	//3Dエフェクト更新処理
	CEffect3D::Update();
}

//===========================================================================================================
// 描画処理
//===========================================================================================================
void CTarget::Draw()
{
	//3Dエフェクト描画処理
	CEffect3D::Draw();
}

//===========================================================================================================
// 回転処理
//===========================================================================================================
void CTarget::Rotation()
{
	//ローカル変数宣言
	D3DXVECTOR3 rot = GetRot();//角度情報

	//回転処理
	rot.y += ROTATION_SPEED;

	//値が超えないように調整
	if (rot.y > D3DX_PI)
	{
		rot.y = (rot.y - D3DX_PI) - D3DX_PI;
	}

	//更新された角度情報設定
	SetRot(rot);
}

//===========================================================================================================
// ライフ減少処理
//===========================================================================================================
void CTarget::DecLife()
{
	//ローカル変数宣言
	int nLife = GetLife();//ライフ情報

	//ライフ減少
	nLife--;
	SetLife(nLife);

	//ライフが0の場合
	if (nLife <= 0)
	{
		//終了処理
		Uninit();
	}
}
